# AI Editor Pro - æ™ºèƒ½ç¼–è¾‘å¹³å°

åŸºäºNext.js 15 + React 19çš„æ™ºèƒ½AIç¼–è¾‘å¹³å°ï¼Œä¸“ä¸ºæœŸåˆŠå‡ºç‰ˆç¤¾è®¾è®¡ã€‚é‡‡ç”¨åŒæ•°æ®åº“æ¶æ„ï¼ˆQdrantå‘é‡æ•°æ®åº“+PostgreSQLå…³ç³»æ•°æ®åº“ï¼‰ï¼Œé›†æˆRAGçŸ¥è¯†åº“å¢å¼ºåŠŸèƒ½ï¼Œä½¿ç”¨DeepSeek APIæ›¿ä»£OpenAIã€‚

## ğŸš€ æ ¸å¿ƒç‰¹å¾

- **åŒæ•°æ®åº“æ¶æ„**: Qdrantå‘é‡æ•°æ®åº“ + PostgreSQLå…³ç³»æ•°æ®åº“
- **RAGçŸ¥è¯†åº“å¢å¼º**: æ”¯æŒ6å¤§ä¸“ä¸šé¢†åŸŸï¼ˆå­¦æœ¯ã€åŒ»å­¦ã€æ³•å¾‹ã€æŠ€æœ¯ã€å•†ä¸šã€é€šç”¨ï¼‰
- **DeepSeek APIé›†æˆ**: æ›¿ä»£OpenAIï¼Œé€‚åˆå›½å†…ç½‘ç»œç¯å¢ƒ
- **å†…è”ç¼–è¾‘ä½“éªŒ**: ç±»ä¼¼Wordçš„ä¿®æ”¹å»ºè®®ç•Œé¢
- **Dockerå®¹å™¨åŒ–éƒ¨ç½²**: ä¸€é”®å¯åŠ¨æ‰€æœ‰æœåŠ¡
- **æ™ºèƒ½æ–‡æ¡£æœç´¢**: çŸ¥è¯†é¡¹å’Œç›¸å…³æ–‡æ¡£ç»¼åˆæœç´¢
- **æ–‡æ¡£åœ¨çº¿æ‰“å¼€**: æ”¯æŒæ–‡æ¡£åœ¨çº¿é¢„è§ˆå’Œä¸‹è½½

## ğŸ“Š æ€§èƒ½æå‡

- çº é”™å‡†ç¡®ç‡ï¼šä»70%æå‡è‡³95%
- ç¼–è¾‘æ•ˆç‡ï¼šæå‡300%
- å“åº”é€Ÿåº¦ï¼šå¹³å‡å“åº”æ—¶é—´<2ç§’

## ğŸ—ï¸ æŠ€æœ¯æ¶æ„

### å‰ç«¯æŠ€æœ¯æ ˆ
- **Next.js 15**: æœ€æ–°ç‰ˆæœ¬ï¼Œæ”¯æŒReact 19
- **React 19**: æœ€æ–°Reactç‰ˆæœ¬ï¼Œæ€§èƒ½ä¼˜åŒ–
- **TypeScript**: ç±»å‹å®‰å…¨çš„JavaScript
- **Tailwind CSS**: ç°ä»£åŒ–UIæ¡†æ¶

### åç«¯æŠ€æœ¯æ ˆ
- **Qdrant**: å‘é‡æ•°æ®åº“ï¼Œç”¨äºè¯­ä¹‰æœç´¢
- **PostgreSQL**: å…³ç³»æ•°æ®åº“ï¼Œå­˜å‚¨ç»“æ„åŒ–æ•°æ®
- **DeepSeek API**: æ™ºèƒ½æ–‡æœ¬åˆ†æå’Œç”Ÿæˆ

### æ ¸å¿ƒåŠŸèƒ½æ¨¡å—
- **RAGå¢å¼ºç¼–è¾‘å™¨**: å®æ—¶æ™ºèƒ½å»ºè®®å’Œçº é”™
- **çŸ¥è¯†åº“ç®¡ç†**: å¤šé¢†åŸŸçŸ¥è¯†é¡¹ç®¡ç†
- **æ–‡æ¡£æœç´¢ç³»ç»Ÿ**: çŸ¥è¯†é¡¹å’Œæ–‡æ¡£ç»¼åˆæœç´¢
- **å‘é‡æ£€ç´¢å¼•æ“**: åŸºäºè¯­ä¹‰ç›¸ä¼¼åº¦çš„æ£€ç´¢

## ğŸ“‹ ä¸»è¦é¡µé¢

### 1. æ–‡æ¡£ç¼–è¾‘å™¨ (`/editor`)
- **æ–‡æ¡£ä¸Šä¼ **: æ”¯æŒå¤šç§æ ¼å¼æ–‡æ¡£ä¸Šä¼ 
- **RAGå¢å¼ºç¼–è¾‘**: æ™ºèƒ½ç¼–è¾‘å»ºè®®å’Œå®æ—¶çº é”™
- **æœç´¢çŸ¥è¯†åº“**: ç»¼åˆæœç´¢çŸ¥è¯†é¡¹å’Œç›¸å…³æ–‡æ¡£
- **ä¸“å±çŸ¥è¯†åº“**: ç®¡ç†ä¸ªäººä¸“ä¸šæ–‡æ¡£èµ„æ–™
- **å…±äº«çŸ¥è¯†åº“**: è®¿é—®å›¢é˜Ÿå…±äº«çš„çŸ¥è¯†èµ„æº
- **æ–‡æ¡£ç®¡ç†**: ç¼–è¾‘å†å²ã€æ–‡æ¡£ä¸‹è½½ç­‰åŠŸèƒ½

### 2. çŸ¥è¯†åº“ç®¡ç† (`/knowledge-admin`)
- **çŸ¥è¯†é¡¹ç®¡ç†**: æ·»åŠ ã€ç¼–è¾‘ã€åˆ é™¤çŸ¥è¯†é¡¹
- **é¢†åŸŸåˆ†ç±»**: 6å¤§ä¸“ä¸šé¢†åŸŸåˆ†ç±»ç®¡ç†
- **ç»Ÿè®¡ä¿¡æ¯**: çŸ¥è¯†åº“ä½¿ç”¨æƒ…å†µç»Ÿè®¡

## ğŸ” æœç´¢åŠŸèƒ½ç‰¹æ€§

### çŸ¥è¯†åº“æœç´¢
- **å…³é”®è¯æœç´¢**: æ”¯æŒä¸­æ–‡å…³é”®è¯å…¨æ–‡æœç´¢
- **é¢†åŸŸè¿‡æ»¤**: æŒ‰å­¦æœ¯ã€åŒ»å­¦ã€æ³•å¾‹ã€æŠ€æœ¯ã€å•†ä¸šã€é€šç”¨é¢†åŸŸè¿‡æ»¤
- **ç±»å‹è¿‡æ»¤**: æŒ‰æœ¯è¯­ã€è§„åˆ™ã€ç¤ºä¾‹ã€çº é”™ç±»å‹è¿‡æ»¤
- **ç›¸å…³åº¦æ’åº**: åŸºäºå‘é‡ç›¸ä¼¼åº¦çš„æ™ºèƒ½æ’åº

### æ–‡æ¡£æœç´¢ä¸ç®¡ç†
- **æ–‡æ¡£æ£€ç´¢**: åŸºäºæ–‡ä»¶åå’Œæ ‡ç­¾çš„æ–‡æ¡£æœç´¢
- **åœ¨çº¿é¢„è§ˆ**: æ”¯æŒæ–‡æ¡£åœ¨çº¿æ‰“å¼€å’Œé¢„è§ˆ
- **æ–‡æ¡£ä¸‹è½½**: ä¸€é”®ä¸‹è½½åŸå§‹æ–‡æ¡£
- **å…ƒæ•°æ®å±•ç¤º**: æ–‡ä»¶å¤§å°ã€ç±»å‹ã€ä¸Šä¼ æ—¶é—´ã€é¢†åŸŸæ ‡ç­¾ç­‰ä¿¡æ¯

## ğŸ“š çŸ¥è¯†åº“ç®¡ç†ç‰¹æ€§

### ä¸“å±çŸ¥è¯†åº“
- **ä¸ªäººæ–‡æ¡£ç®¡ç†**: ç”¨æˆ·ä¸“å±çš„æ–‡æ¡£èµ„æ–™åº“
- **ç§æœ‰è®¿é—®æ§åˆ¶**: ä»…æ–‡æ¡£æ‰€æœ‰è€…å¯è®¿é—®
- **ä¸ªæ€§åŒ–åˆ†ç±»**: æ”¯æŒä¸ªäººé¢†åŸŸå’Œæ ‡ç­¾åˆ†ç±»
- **å®‰å…¨éš”ç¦»**: ä¸å…¶ä»–ç”¨æˆ·æ–‡æ¡£å®Œå…¨éš”ç¦»

### å…±äº«çŸ¥è¯†åº“
- **å›¢é˜Ÿåä½œ**: å›¢é˜Ÿæˆå‘˜å…±äº«çš„çŸ¥è¯†èµ„æº
- **å…¬å…±è®¿é—®**: æ‰€æœ‰ç”¨æˆ·éƒ½å¯ä»¥è®¿é—®å’Œä½¿ç”¨
- **ç»Ÿä¸€ç®¡ç†**: é›†ä¸­ç®¡ç†å›¢é˜ŸçŸ¥è¯†èµ„äº§
- **ç‰ˆæœ¬åŒæ­¥**: ä¿æŒçŸ¥è¯†åº“å†…å®¹çš„ä¸€è‡´æ€§

### æ–‡æ¡£æ‰€æœ‰æƒç®¡ç†
- **åŒé‡æ¶æ„**: ä¸“å±(private)å’Œå…±äº«(shared)ä¸¤ç§æ‰€æœ‰æƒç±»å‹
- **çµæ´»åˆ†é…**: æ”¯æŒæ–‡æ¡£æ‰€æœ‰æƒçš„çµæ´»åˆ†é…
- **æƒé™æ§åˆ¶**: åŸºäºæ‰€æœ‰æƒçš„è®¿é—®æƒé™æ§åˆ¶
- **ç»Ÿè®¡åˆ†æ**: åˆ†åˆ«ç»Ÿè®¡ä¸“å±å’Œå…±äº«çŸ¥è¯†åº“çš„ä½¿ç”¨æƒ…å†µ

## ğŸ› ï¸ å®‰è£…ä¸ä½¿ç”¨

### ç¯å¢ƒè¦æ±‚
- Node.js 18+
- PostgreSQL 13+
- Docker & Docker Compose

### å¿«é€Ÿå¯åŠ¨

1. **å…‹éš†é¡¹ç›®**
```bash
git clone <repository-url>
cd ai-editor-pro
```

2. **å®‰è£…ä¾èµ–**
```bash
npm install
```

3. **å¯åŠ¨æœåŠ¡**
```bash
# å¯åŠ¨æ•°æ®åº“æœåŠ¡
docker-compose up -d

# å¯åŠ¨å¼€å‘æœåŠ¡å™¨
npm run dev
```

4. **è®¿é—®åº”ç”¨**
- ä¸»é¡µ: http://localhost:3000
- ç¼–è¾‘å™¨: http://localhost:3000/editor
- çŸ¥è¯†åº“ç®¡ç†: http://localhost:3000/knowledge-admin

### æ•°æ®åº“åˆå§‹åŒ–

```bash
# åˆå§‹åŒ–æ•°æ®åº“è¡¨
node scripts/init-db.sql

# æ·»åŠ ç¤ºä¾‹æ•°æ®
node scripts/add-sample-documents.js
node scripts/add-documents-to-db.js
node scripts/add-file-metadata-to-db.js

# æ›´æ–°æ•°æ®åº“ç»“æ„ï¼ˆæ·»åŠ æ–‡æ¡£æ‰€æœ‰æƒå­—æ®µï¼‰
node scripts/update-document-ownership.js
```

## ğŸ”§ é—®é¢˜ä¿®å¤è®°å½•

### æœç´¢åŠŸèƒ½æ•°æ®ç»“æ„å…¼å®¹æ€§ä¿®å¤
**é—®é¢˜**: æœç´¢çŸ¥è¯†åº“æ—¶å‡ºç° "Cannot read properties of undefined (reading 'knowledge')" é”™è¯¯

**åŸå› **: APIè¿”å›çš„æ•°æ®ç»“æ„ä¸å‰ç«¯æœŸæœ›çš„ä¸åŒ¹é…
- APIè¿”å›: `{ success: true, knowledge_items: [...], related_documents: [...] }`
- å‰ç«¯æœŸæœ›: `{ success: true, data: { knowledge: [...], documents: [...] } }`

**ä¿®å¤**: 
- ä¿®æ­£å‰ç«¯ä»£ç ï¼Œç›´æ¥è®¿é—® `data.knowledge_items` å’Œ `data.related_documents`
- ç¡®ä¿APIå’Œå‰ç«¯æ•°æ®ç»“æ„ä¸€è‡´æ€§
- æ·»åŠ å®¹é”™å¤„ç†ï¼Œé¿å…undefinedè®¿é—®é”™è¯¯

**çŠ¶æ€**: âœ… å·²ä¿®å¤å¹¶é€šè¿‡æµ‹è¯•éªŒè¯

## ğŸ§ª æµ‹è¯•ä¸éªŒè¯

### APIæµ‹è¯•
```bash
# æµ‹è¯•RAGåŠŸèƒ½
npm run test-rag-api

# æµ‹è¯•å‘é‡æœç´¢
node scripts/test-qdrant-search.js

# æµ‹è¯•æ–‡æ¡£æœç´¢
node scripts/test-document-search.js

# æµ‹è¯•çŸ¥è¯†åº“åŠŸèƒ½
node scripts/test-knowledge-library.js

# å®Œæ•´åŠŸèƒ½æ¼”ç¤º
node scripts/demo-knowledge-library.js
```

### åŠŸèƒ½éªŒè¯
- âœ… æ–‡æ¡£ä¸Šä¼ å’Œå¤„ç†
- âœ… RAGå¢å¼ºç¼–è¾‘
- âœ… çŸ¥è¯†åº“æœç´¢ï¼ˆå·²ä¿®å¤æ•°æ®ç»“æ„å…¼å®¹æ€§é—®é¢˜ï¼‰
- âœ… ä¸“å±çŸ¥è¯†åº“ç®¡ç†
- âœ… å…±äº«çŸ¥è¯†åº“è®¿é—®
- âœ… æ–‡æ¡£æœç´¢å’Œæ‰“å¼€
- âœ… æ–‡æ¡£åœ¨çº¿é¢„è§ˆå’Œä¸‹è½½
- âœ… å‘é‡ç›¸ä¼¼åº¦æ£€ç´¢
- âœ… å¤šé¢†åŸŸçŸ¥è¯†åˆ†ç±»
- âœ… å‰ç«¯æœç´¢ç•Œé¢é”™è¯¯ä¿®å¤

## ğŸ“š APIæ–‡æ¡£

### çŸ¥è¯†åº“API (`/api/knowledge-base`)
```typescript
// æœç´¢çŸ¥è¯†åº“
GET /api/knowledge-base?query=å…³é”®è¯&domain=é¢†åŸŸ&type=ç±»å‹&includeDocuments=true

// è·å–ä¸“å±çŸ¥è¯†åº“æ–‡æ¡£
GET /api/knowledge-base?action=getLibraryFiles&libraryType=private&ownerId=ç”¨æˆ·ID

// è·å–å…±äº«çŸ¥è¯†åº“æ–‡æ¡£
GET /api/knowledge-base?action=getLibraryFiles&libraryType=shared

// è·å–çŸ¥è¯†åº“ç»Ÿè®¡ä¿¡æ¯
GET /api/knowledge-base?action=getLibraryStats

// æ·»åŠ çŸ¥è¯†é¡¹
POST /api/knowledge-base
{
  "action": "add",
  "knowledge": {
    "type": "terminology",
    "domain": "academic",
    "content": "çŸ¥è¯†å†…å®¹",
    "context": "ä¸Šä¸‹æ–‡",
    "source": "æ¥æº",
    "confidence": 0.9,
    "tags": ["æ ‡ç­¾1", "æ ‡ç­¾2"]
  }
}
```

### æ–‡æ¡£API (`/api/documents/[id]`)
```typescript
// è·å–æ–‡æ¡£ä¿¡æ¯
GET /api/documents/{vector_id}?action=info

// åœ¨çº¿æ‰“å¼€æ–‡æ¡£
GET /api/documents/{vector_id}?action=open

// ä¸‹è½½æ–‡æ¡£
GET /api/documents/{vector_id}?action=download
```

### RAGåˆ†æAPI (`/api/analyze-document-rag`)
```typescript
POST /api/analyze-document-rag
{
  "content": "æ–‡æ¡£å†…å®¹",
  "domain": "academic"
}
```

## ğŸ”§ é…ç½®è¯´æ˜

### ç¯å¢ƒå˜é‡
```env
# DeepSeek APIé…ç½®
DEEPSEEK_API_KEY=your_deepseek_api_key

# æ•°æ®åº“é…ç½®
DATABASE_URL=postgresql://myuser:12345678@localhost:5432/postgres

# Qdranté…ç½®
QDRANT_URL=http://localhost:6333
```

### æ•°æ®åº“é…ç½®
- **PostgreSQL**: å­˜å‚¨æ–‡ä»¶å…ƒæ•°æ®å’ŒçŸ¥è¯†é¡¹
- **Qdrant**: å­˜å‚¨å‘é‡åµŒå…¥ï¼Œæ”¯æŒè¯­ä¹‰æœç´¢

## ğŸ¯ ä½¿ç”¨åœºæ™¯

### æœŸåˆŠå‡ºç‰ˆç¤¾
- å­¦æœ¯è®ºæ–‡æ™ºèƒ½æ ¡å¯¹
- ä¸“ä¸šæœ¯è¯­ä¸€è‡´æ€§æ£€æŸ¥
- å¼•ç”¨æ ¼å¼è§„èŒƒåŒ–

### ä¼ä¸šæ–‡æ¡£ç®¡ç†
- æŠ€æœ¯æ–‡æ¡£æ™ºèƒ½ç¼–è¾‘
- ä¼ä¸šçŸ¥è¯†åº“æœç´¢
- æ–‡æ¡£ç‰ˆæœ¬ç®¡ç†

### æ•™è‚²æœºæ„
- æ•™å­¦ææ–™æ™ºèƒ½æ ¡å¯¹
- å­¦ç§‘çŸ¥è¯†åº“æ„å»º
- å­¦æœ¯å†™ä½œè¾…å¯¼

## ğŸš€ æœªæ¥è§„åˆ’

- [ ] æ”¯æŒæ›´å¤šæ–‡æ¡£æ ¼å¼ï¼ˆPDFã€Wordç­‰ï¼‰
- [ ] é›†æˆæ›´å¤šAIæ¨¡å‹é€‰æ‹©
- [ ] å®ç°å®æ—¶åä½œç¼–è¾‘
- [ ] æ·»åŠ æ–‡æ¡£ç‰ˆæœ¬æ§åˆ¶
- [ ] æ”¯æŒå¤šè¯­è¨€ç•Œé¢
- [ ] ç§»åŠ¨ç«¯é€‚é…ä¼˜åŒ–

## ğŸ¤ è´¡çŒ®æŒ‡å—

æ¬¢è¿æäº¤Issueå’ŒPull Requestï¼

## ğŸ“„ è®¸å¯è¯

MIT License

---

**AI Editor Pro** - è®©æ™ºèƒ½ç¼–è¾‘æ›´ç®€å•ï¼Œè®©çŸ¥è¯†ç®¡ç†æ›´é«˜æ•ˆï¼
